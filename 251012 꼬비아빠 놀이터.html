<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>꼬비아빠 놀이터</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/decimal.js/10.4.3/decimal.min.js"></script>
<style>
  /* 바디 레벨 플로팅 툴팁 */
  .floating-tip{
    position: fixed; z-index: 9999; max-width: 360px;
    background:#0b1320; color:#cfe1ff; border:1px solid #2b3a55;
    border-radius:10px; padding:8px 10px; font-size:12px; line-height:1.35;
    box-shadow:0 8px 24px rgba(0,0,0,.35);
    pointer-events:none; white-space:normal; word-break:keep-all;
    opacity:0; transform: translateY(4px);
    transition: opacity .12s ease, transform .12s ease;
  }
  .floating-tip.show{ opacity:1; transform: translateY(0); }
  .floating-tip::after{
    content:""; position:absolute; width:10px; height:10px; left:50%;
    transform: translateX(-50%) rotate(45deg);
    background:#0b1320; border-left:1px solid #2b3a55; border-top:1px solid #2b3a55;
  }
  .floating-tip[data-pos="top"]::after{ bottom:-5px; }
  .floating-tip[data-pos="bottom"]::after{ top:-5px; transform: translateX(-50%) rotate(225deg); }

  :root{
    --bg:#0f1115; --panel:#161a22; --muted:#8a9099; --accent:#6aa0ff;
    --ok:#35c759; --warn:#ffb300; --bad:#ff5171; --chip:#232a36;
    --ring:#1f2530; --text:#e8ecf3; --highlight:#fff;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
    background:linear-gradient(180deg,#0f1115 0%,#0c0f14 100%); color:var(--text);
  }
  header{
    display:flex; align-items:center; justify-content:space-between;
    padding:16px 20px; border-bottom:1px solid #232a36; background:rgba(0,0,0,.2);
    position:sticky; top:0; z-index:10;
  }
  .brand{font-weight:700; letter-spacing:.3px}
  .ver{color:var(--muted); font-size:12px; display:flex; align-items:center; gap:10px}
  .grid{ max-width:1300px; margin:20px auto; padding:0 16px; display:grid; gap:16px; grid-template-columns: 1fr 1fr; }
  @media (max-width: 980px){ .grid{grid-template-columns:1fr} }
  .card{background:var(--panel); border:1px solid #232a36; border-radius:14px; padding:16px; box-shadow:0 6px 24px rgba(0,0,0,.25);}
  .full-width { grid-column: 1 / -1; }
  .card h3{margin:4px 0 12px 0; font-size:16px}
  .row{display:flex; gap:8px; flex-wrap:wrap}
  .col{flex:1 1 0}
  label{display:block; font-size:12px; color:var(--muted); margin:6px 0 4px 2px}
  input[type="number"], input[type="text"]{
    width:100%; padding:10px 12px; border-radius:10px; border:1px solid #2a3040;
    background:#0e1218; color:var(--text); outline:none;
  }
  input[readonly]{opacity:.7; cursor:not-allowed}
  input[type="number"]::-webkit-outer-spin-button,
  input[type="number"]::-webkit-inner-spin-button{ -webkit-appearance:none; margin:0; }
  .btn{ padding:10px 14px; border-radius:10px; border:1px solid #334055; cursor:pointer; background:#142033; color:#cfe1ff; font-weight:600; }
  .btn:hover{filter:brightness(1.1)}
  .btn.primary{ background:linear-gradient(180deg,#2b71ff,#1d56cc); border-color:transparent; color:white;}
  .btn.ghost{ background:transparent;}
  .btn-sm{padding:6px 10px; font-size:12px; border-radius:8px}
  .muted{color:var(--muted)}
  .chips{display:flex; gap:8px; flex-wrap:wrap}
  .chip{ background:var(--chip); color:#cfd6e3; border:1px solid #2b3242; border-radius:999px; padding:6px 10px; font-size:12px; cursor:pointer; }
  .chip.on{outline:2px solid var(--accent)}
  .kbd{display:inline-block; border:1px solid #404a5e; border-bottom-width:3px; padding:2px 6px; border-radius:6px; background:#0e131a; font-weight:700}
  .chooser{display:grid; grid-template-columns: 1fr; gap:8px}
  .list{ max-height:260px; overflow:auto; border:1px solid #2a3040; border-radius:10px; padding:6px; background:#0d1117; }
  .item{padding:8px 10px; border-radius:8px; cursor:pointer; display:flex; justify-content:space-between; align-items:center; transition: background .12s ease, outline-color .12s ease; }
  .item:hover{background:#19202b}
  .item.selected{ background:#1b2535; outline:2px solid #30518d; }
  .tags{display:flex; gap:6px; align-items:center}
  .tag{font-size:11px;border:1px solid #2b3242;border-radius:999px;padding:2px 8px}
  .tag.ok{border-color:#275a34; background:#102214; color:#35c759}
  .tag.warn{border-color:#7a5b0e; background:#241a05; color:#ffb300}
  .tag.rank8{border-color:#2b4a82; background:#0d1a33; color:#88b5ff}
  .kpis{display:grid; grid-template-columns: repeat(3, 1fr); gap:12px}
  @media (max-width: 720px){ .kpis{grid-template-columns: 1fr} }
  .kpi{ display:flex; gap:14px; align-items:center; border:1px solid #2a3040; border-radius:14px; padding:14px; background:radial-gradient(120px 120px at 20% -10%, #11224444, transparent); }
  .ring{width:60px; height:60px; border-radius:50%; background:conic-gradient(var(--accent) 0deg, var(--accent) var(--p,0deg), var(--ring) var(--p,0deg)); display:grid; place-items:center}
  .ring::after{content:""; width:48px; height:48px; background:#0c1016; border-radius:50%; display:block}
  .kpi strong{font-size:20px; color:var(--highlight)}
  .kpi small{display:block; color:var(--muted)}
  .table{width:100%; border-collapse:collapse; font-size:13px}
  .table th,.table td{border-bottom:1px solid #262d3a; padding:8px 6px; text-align:right}
  .table th:first-child,.table td:first-child{text-align:left}
  .badge{display:inline-block; min-width:34px; text-align:center; padding:2px 6px; border-radius:6px; background:#223; border:1px solid #356}
  .ok{color:var(--ok)} .warn{color:var(--warn)} .bad{color:var(--bad)}
  .footer{max-width:1100px; margin:8px auto 30px; padding:0 16px; color:var(--muted); font-size:12px; text-align: center;}
  .stepper{display:flex; gap:6px; margin-top:6px}

  /* 라이트 모드 스타일 */
  body.light {
    --bg:#f8f9fa; 
    --panel:#ffffff; 
    --muted:#6c757d; 
    --accent:#0d6efd;
    --ok:#198754; 
    --warn:#ffc107; 
    --bad:#dc3545; 
    --chip:#e9ecef;
    --ring:#dee2e6; 
    --text:#212529; 
    --highlight:#000;
    --ring:#495057;
  }
  body.light{
    background: var(--bg);
  }
  body.light .card, body.light header{
    border-color: #dee2e6;
    box-shadow: 0 6px 24px rgba(0,0,0,.08);
  }
  body.light input[type="number"], 
  body.light input[type="text"],
  body.light .list {
    background: #f8f9fa;
    border-color: #ced4da;
  }
  body.light .item:hover{background:#e9ecef}
  body.light .item.selected{ background:#dee2e6; outline-color:#adb5bd; }
  body.light .btn{ background:#e9ecef; border-color:#ced4da; color: var(--text); }
  body.light .btn:hover{filter:brightness(.95)}
  body.light .btn.primary{ background:linear-gradient(180deg,#0d6efd,#0a58ca); border-color:transparent; color:white;}
  body.light .chip{ background:#f8f9fa; border-color:#ced4da; }
  body.light .kbd { background: #e9ecef; border-color: #adb5bd; }
  body.light .ring::after { background: #f0f2f5; }
  body.light .badge { background: #e9ecef; border-color: #ced4da; color: var(--text);}
  body.light .floating-tip, body.light .floating-tip::after { background: #fff; color: #212529; border-color: #dee2e6;}
  body.light .table th, body.light .table td { border-bottom-color: #dee2e6; }
</style>
</head>
<body>
<header>
  <div class="brand">꼬비아빠 놀이터</div>
  <div class="ver">
    <span>데이터 기준 2025.10.08</span>
    <button id="theme-toggle" class="btn ghost">라이트 모드</button>
  </div>
</header>

<div class="grid">
    <!-- 안내 -->
    <section class="card full-width">
        <h3>안내사항</h3>
        <p class="muted" style="margin: 0; font-size: 14px;">
          - 입력된 페트 능력치에는 오타가 있을 수 있으니 페트 조회 시 게임 내 페트의 초기치 및 성장률이 같은지 확인하세요. <br>
          - 업데이트로 추가되는 페트와 기존 페트의 성장률 변경시 데이터가 다르게 나올 수 있습니다. <br>
          - 특이사항 : 꼬비 / 남아 / 푸들(갈색) / 20.03.24 출생 / 중성화 O
        </p>
    </section>

  <!-- 좌: 펫 선택 -->
  <section class="card">
    <h3>① 페트 선택</h3>
    <div class="row">
      <div class="col chooser">
        <label>페트 초성</label>
        <div id="chosung" class="chips"></div>

        <div class="row" style="margin-top:6px; align-items:center">
          <span class="muted" style="min-width:78px">선택한 초성</span>
          <div id="chosungTokens" class="chips" style="min-height:28px"></div>
        </div>

        <div class="row" style="margin-top:8px">
          <div class="col">
            <input type="text" id="petSearch" placeholder="페트 이름으로 검색 (예: 막쿠마, 한가름)" />
          </div>
          <button class="btn" id="btnClear">지우기</button>
        </div>
        <div class="list" id="petList"></div>
      </div>
    </div>
    <p class="muted" style="margin-top:8px">팁 : 초성만 두세번 눌러도 검색이 가능합니다. (예: 막쿠마 = <span class="kbd">ㅁ</span>→<span class="kbd">ㅋ</span>→<span class="kbd">ㅁ</span>)</p>
  </section>

  <!-- 우: 표기 S0 / Sg + 관측 입력 -->
  <section class="card">
    <h3>② 능력치 확인 및 계산</h3>

    <div class="row">
      <div class="col">
        <label>S급 기준 초기치 (체/공/방/순)</label>
        <div class="row">
          <div class="col"><input type="number" id="s0_hp"  step="0.01" placeholder="—" readonly /></div>
          <div class="col"><input type="number" id="s0_atk" step="0.01" placeholder="—" readonly /></div>
          <div class="col"><input type="number" id="s0_def" step="0.01" placeholder="—" readonly /></div>
          <div class="col"><input type="number" id="s0_agi" step="0.01" placeholder="—" readonly /></div>
        </div>

        <label style="margin-top:10px">S급 기준 성장률 (체/공/방/순)</label>
        <div class="row">
          <div class="col"><input type="number" id="sg_hp"  step="0.01" placeholder="—" readonly /></div>
          <div class="col"><input type="number" id="sg_atk" step="0.01" placeholder="—" readonly /></div>
          <div class="col"><input type="number" id="sg_def" step="0.01" placeholder="—" readonly /></div>
          <div class="col"><input type="number" id="sg_agi" step="0.01" placeholder="—" readonly /></div>
        </div>
      </div>
    </div>

    <hr style="border:none;border-top:1px solid #2a3040; margin:14px 0" />

    <div class="row">
      <div class="col">
        <label>내 페트 Lv 1 초기치 — 체/공/방/순</label>
        <div class="row">
          <div class="col">
            <input type="number" id="obs_hp"  step="1" />
            <div class="stepper">
              <button class="btn btn-sm" data-target="obs_hp" data-delta="-1">-1</button>
              <button class="btn btn-sm" data-target="obs_hp" data-delta="1">+1</button>
            </div>
          </div>
          <div class="col">
            <input type="number" id="obs_atk" step="1" />
            <div class="stepper">
              <button class="btn btn-sm" data-target="obs_atk" data-delta="-1">-1</button>
              <button class="btn btn-sm" data-target="obs_atk" data-delta="1">+1</button>
            </div>
          </div>
          <div class="col">
            <input type="number" id="obs_def" step="1" />
            <div class="stepper">
              <button class="btn btn-sm" data-target="obs_def" data-delta="-1">-1</button>
              <button class="btn btn-sm" data-target="obs_def" data-delta="1">+1</button>
            </div>
          </div>
          <div class="col">
            <input type="number" id="obs_agi" step="1" />
            <div class="stepper">
              <button class="btn btn-sm" data-target="obs_agi" data-delta="-1">-1</button>
              <button class="btn btn-sm" data-target="obs_agi" data-delta="1">+1</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row" style="margin-top:12px">
      <button class="btn primary" id="btnCalc">계산</button>
      <button class="btn ghost" id="btnReset">리셋</button>
      <span class="muted" style="margin-left:auto"> 클릭 후 마우스 휠로 Up/Down 가능</span>
    </div>
  </section>

  <!-- 하단: KPI 강조 -->
  <section class="card full-width" id="resultCard">
    <h3>③ 등급 분석</h3>
    <div class="kpis">
      <div class="kpi">
        <div class="ring" id="ringSuccess" style="--p:0deg"></div>
        <div>
          <strong id="kpiSuccess">—%</strong>
          <small>환각(8등급) 확률</small>
        </div>
      </div>
      <div class="kpi">
        <div class="ring" id="ringAppear" style="--p:0deg"></div>
        <div>
          <strong id="kpiAppear">—%</strong>
          <small>출현 확률</small>
        </div>
      </div>
      <div class="kpi">
        <div class="ring" style="--p:360deg; background:conic-gradient(#888 360deg, #888 360deg, var(--ring) 360deg)"></div>
        <div>
          <strong id="kpiTries">—</strong>
          <small>성공 기대값(시도)</small>
        </div>
      </div>
    </div>

    <div style="margin-top:14px">
      <div class="row">
        <div class="col"><span class="muted">총 경우의 수:</span> <span class="badge" id="totMatches">—</span></div>
        <div class="col"><span class="muted">환각 매칭:</span> <span class="badge" id="rank8Matches">—</span></div>
        <!-- <div class="col"><span class="muted">전수(고정):</span> <span class="badge">178,750</span></div> -->
      </div>
    </div>

    <details style="margin-top:12px">
      <summary>등급 분포 자세히 보기</summary>
      <div id="dist"></div>
    </details>
  </section>
</div>

<div class="footer">
  <p> Data by. 꼬비아빠 </p>
</div>

<script>
/* ========= 꼬비아빠 페트 데이터 ========= */
const kkobyPetData = [
    {"name":"우리","initnum":10,"hp":20,"atk":12,"def":15,"agi":25},
    {"name":"두리","initnum":20,"hp":22,"atk":23,"def":11,"agi":23},
    {"name":"얼룩우리","initnum":15,"hp":22,"atk":17,"def":19,"agi":17},
    {"name":"불그리","initnum":10,"hp":25,"atk":23,"def":19,"agi":33},
    {"name":"실버우리","initnum":20,"hp":22,"atk":22,"def":24,"agi":27},
    {"name":"환생얼룩우리","initnum":25,"hp":30,"atk":24,"def":27,"agi":24},
    {"name":"복우리","initnum":21,"hp":21,"atk":19,"def":19,"agi":28},
    {"name":"푸우리","initnum":21,"hp":25,"atk":27,"def":11,"agi":25},
    {"name":"녹우리","initnum":20,"hp":26,"atk":32,"def":21,"agi":24},
    {"name":"우리스타","initnum":18,"hp":22,"atk":14,"def":18,"agi":28},
    {"name":"핑우리","initnum":21,"hp":25,"atk":34,"def":19,"agi":25},
    {"name":"부비","initnum":15,"hp":42,"atk":20,"def":16,"agi":12},
    {"name":"골드부비","initnum":25,"hp":31,"atk":20,"def":32,"agi":12},
    {"name":"부이","initnum":22,"hp":44,"atk":21,"def":16,"agi":13},
    {"name":"부이비","initnum":16,"hp":32,"atk":26,"def":15,"agi":18},
    {"name":"얼룩부이비","initnum":23,"hp":30,"atk":28,"def":14,"agi":20},
    {"name":"푸비","initnum":24,"hp":31,"atk":34,"def":24,"agi":18},
    {"name":"푸이","initnum":24,"hp":34,"atk":36,"def":21,"agi":18},
    {"name":"깡우비","initnum":18,"hp":29,"atk":30,"def":15,"agi":20},
    {"name":"꼬미","initnum":22,"hp":22,"atk":28,"def":15,"agi":27},
    {"name":"꼬비","initnum":22,"hp":22,"atk":27,"def":17,"agi":27},
    {"name":"꼬비오","initnum":22,"hp":21,"atk":27,"def":15,"agi":29},
    {"name":"꼬꼬비","initnum":22,"hp":21,"atk":28,"def":15,"agi":28},
    {"name":"꼬꼬미","initnum":22,"hp":25,"atk":29,"def":17,"agi":28},
    {"name":"꼬이미","initnum":22,"hp":21,"atk":26,"def":18,"agi":22},
    {"name":"돌꼬비","initnum":22,"hp":25,"atk":31,"def":17,"agi":25},
    {"name":"푸미","initnum":22,"hp":27,"atk":31,"def":16,"agi":25},
    {"name":"푸푸","initnum":13,"hp":18,"atk":20,"def":8,"agi":33},
    {"name":"우푸","initnum":15,"hp":18,"atk":22,"def":7,"agi":32},
    {"name":"투투","initnum":17,"hp":23,"atk":22,"def":8,"agi":26},
    {"name":"오투투","initnum":20,"hp":20,"atk":19,"def":15,"agi":30},
    {"name":"포포","initnum":16,"hp":20,"atk":24,"def":8,"agi":36},
    {"name":"푸투투","initnum":14,"hp":29,"atk":23,"def":14,"agi":31},
    {"name":"노투투","initnum":15,"hp":22,"atk":24,"def":13,"agi":39},
    {"name":"푸투","initnum":15,"hp":22,"atk":24,"def":9,"agi":33},
    {"name":"마아란","initnum":26,"hp":23,"atk":29,"def":9,"agi":38},
    {"name":"베론","initnum":23,"hp":42,"atk":18,"def":37,"agi":18},
    {"name":"베로로크","initnum":19,"hp":39,"atk":19,"def":37,"agi":17},
    {"name":"베로보크","initnum":23,"hp":38,"atk":18,"def":36,"agi":14},
    {"name":"베로포리","initnum":22,"hp":34,"atk":25,"def":35,"agi":15},
    {"name":"베노노크","initnum":22,"hp":36,"atk":27,"def":32,"agi":22},
    {"name":"베톤","initnum":22,"hp":40,"atk":24,"def":42,"agi":14},
    {"name":"베노투리","initnum":22,"hp":37,"atk":25,"def":41,"agi":17},
    {"name":"베로바드","initnum":22,"hp":36,"atk":33,"def":31,"agi":19},
    {"name":"베노미","initnum":27,"hp":37,"atk":36,"def":35,"agi":6},
    {"name":"노북이","initnum":14,"hp":22,"atk":18,"def":34,"agi":6},
    {"name":"북이","initnum":14,"hp":22,"atk":19,"def":35,"agi":5},
    {"name":"깡북이","initnum":12,"hp":21,"atk":24,"def":33,"agi":5},
    {"name":"돌북이","initnum":20,"hp":23,"atk":19,"def":41,"agi":4},
    {"name":"물북이","initnum":14,"hp":24,"atk":20,"def":35,"agi":9},
    {"name":"킹북이","initnum":21,"hp":23,"atk":19,"def":42,"agi":4},
    {"name":"철북이","initnum":19,"hp":22,"atk":30,"def":34,"agi":6},
    {"name":"자라북","initnum":20,"hp":28,"atk":26,"def":42,"agi":3},
    {"name":"메카북이","initnum":24,"hp":42,"atk":34,"def":38,"agi":6},
    {"name":"아고아","initnum":20,"hp":25,"atk":39,"def":24,"agi":19},
    {"name":"네고스","initnum":20,"hp":26,"atk":37,"def":26,"agi":18},
    {"name":"타로곤","initnum":20,"hp":25,"atk":37,"def":26,"agi":18},
    {"name":"다고스","initnum":20,"hp":27,"atk":38,"def":23,"agi":18},
    {"name":"보크곤","initnum":20,"hp":23,"atk":38,"def":22,"agi":24},
    {"name":"골드곤","initnum":20,"hp":25,"atk":33,"def":21,"agi":19},
    {"name":"기고아","initnum":20,"hp":23,"atk":34,"def":24,"agi":16},
    {"name":"타로아","initnum":20,"hp":25,"atk":36,"def":21,"agi":17},
    {"name":"뉴로아","initnum":29,"hp":35,"atk":37,"def":27,"agi":20},
    {"name":"라고고","initnum":23,"hp":22,"atk":28,"def":17,"agi":26},
    {"name":"후바바","initnum":24,"hp":22,"atk":25,"def":18,"agi":28},
    {"name":"토루루","initnum":21,"hp":23,"atk":25,"def":23,"agi":27},
    {"name":"루니","initnum":22,"hp":24,"atk":23,"def":25,"agi":22},
    {"name":"푸고고","initnum":24,"hp":26,"atk":28,"def":14,"agi":26},
    {"name":"라루루","initnum":21,"hp":24,"atk":29,"def":15,"agi":29},
    {"name":"기바바","initnum":23,"hp":26,"atk":29,"def":24,"agi":20},
    {"name":"주니","initnum":19,"hp":27,"atk":33,"def":19,"agi":35},
    {"name":"쿠로로","initnum":23,"hp":30,"atk":27,"def":17,"agi":29},
    {"name":"푸루바","initnum":27,"hp":31,"atk":38,"def":11,"agi":33},
    {"name":"카타르카스","initnum":22,"hp":25,"atk":24,"def":40,"agi":5},
    {"name":"쿠카스","initnum":22,"hp":27,"atk":21,"def":39,"agi":6},
    {"name":"코로카스","initnum":17,"hp":29,"atk":26,"def":37,"agi":5},
    {"name":"로기안","initnum":23,"hp":25,"atk":22,"def":39,"agi":7},
    {"name":"램가스","initnum":20,"hp":32,"atk":25,"def":52,"agi":5},
    {"name":"아이카스","initnum":22,"hp":31,"atk":23,"def":40,"agi":5},
    {"name":"쿠타스","initnum":22,"hp":31,"atk":25,"def":33,"agi":5},
    {"name":"카르기안","initnum":20,"hp":25,"atk":22,"def":36,"agi":10},
    {"name":"엘로카스","initnum":24,"hp":35,"atk":28,"def":46,"agi":6,"rank":435},
    {"name":"리비노","initnum":25,"hp":27,"atk":37,"def":19,"agi":17},
    {"name":"얀기로","initnum":27,"hp":27,"atk":36,"def":16,"agi":20},
    {"name":"반보로","initnum":27,"hp":25,"atk":37,"def":16,"agi":21},
    {"name":"반기노","initnum":26,"hp":24,"atk":38,"def":16,"agi":20},
    {"name":"부르돈","initnum":25,"hp":25,"atk":35,"def":14,"agi":24},
    {"name":"기라노","initnum":26,"hp":32,"atk":42,"def":19,"agi":23},
    {"name":"기비노","initnum":24,"hp":25,"atk":39,"def":13,"agi":21},
    {"name":"프로돈","initnum":25,"hp":36,"atk":39,"def":17,"agi":25},
    {"name":"메카반보로","initnum":23,"hp":31,"atk":43,"def":20,"agi":24},
    {"name":"쿠링","initnum":19,"hp":23,"atk":20,"def":22,"agi":24},
    {"name":"쿠쿠르","initnum":20,"hp":24,"atk":20,"def":19,"agi":26},
    {"name":"포링","initnum":18,"hp":22,"atk":20,"def":18,"agi":24},
    {"name":"리스키","initnum":17,"hp":26,"atk":18,"def":21,"agi":24},
    {"name":"노스키","initnum":18,"hp":22,"atk":22,"def":21,"agi":29},
    {"name":"라스키","initnum":17,"hp":26,"atk":30,"def":18,"agi":29},
    {"name":"토끼","initnum":17,"hp":32,"atk":30,"def":23,"agi":33},
    {"name":"범링","initnum":22,"hp":26,"atk":28,"def":20,"agi":30},
    {"name":"메카리스키","initnum":23,"hp":32,"atk":35,"def":9,"agi":41},
    {"name":"카비트","initnum":18,"hp":14,"atk":19,"def":19,"agi":27},
    {"name":"케이비","initnum":20,"hp":14,"atk":19,"def":19,"agi":27},
    {"name":"큐이","initnum":15,"hp":13,"atk":20,"def":17,"agi":25},
    {"name":"골드카비트","initnum":19,"hp":16,"atk":20,"def":16,"agi":28},
    {"name":"블루카비트","initnum":21,"hp":25,"atk":24,"def":12,"agi":26},
    {"name":"연두큐이","initnum":21,"hp":23,"atk":25,"def":14,"agi":24},
    {"name":"키라비","initnum":22,"hp":21,"atk":25,"def":11,"agi":26},
    {"name":"카이비","initnum":21,"hp":22,"atk":25,"def":15,"agi":25},
    {"name":"고르돈","initnum":24,"hp":27,"atk":31,"def":24,"agi":18},
    {"name":"기라돈","initnum":24,"hp":28,"atk":31,"def":22,"agi":19},
    {"name":"투르돈","initnum":24,"hp":26,"atk":28,"def":16,"agi":16},
    {"name":"고르고","initnum":24,"hp":22,"atk":29,"def":16,"agi":16},
    {"name":"철기돈","initnum":24,"hp":26,"atk":33,"def":23,"agi":21},
    {"name":"실버고르돈","initnum":27,"hp":28,"atk":30,"def":19,"agi":17},
    {"name":"고라돈","initnum":27,"hp":25,"atk":29,"def":25,"agi":15},
    {"name":"노라돈","initnum":24,"hp":28,"atk":33,"def":19,"agi":22},
    {"name":"그린고르","initnum":25,"hp":28,"atk":28,"def":30,"agi":4},
    {"name":"킹고르","initnum":25,"hp":35,"atk":38,"def":25,"agi":19},
    {"name":"그램고르","initnum":22,"hp":31,"atk":34,"def":32,"agi":19},
    {"name":"지고르","initnum":22,"hp":31,"atk":39,"def":24,"agi":21},
    {"name":"가론고르","initnum":26,"hp":31,"atk":42,"def":23,"agi":20},
    {"name":"고루바","initnum":25,"hp":31,"atk":31,"def":34,"agi":21},
    {"name":"휴보","initnum":18,"hp":26,"atk":28,"def":25,"agi":16},
    {"name":"포보","initnum":19,"hp":28,"atk":23,"def":26,"agi":14},
    {"name":"쿠보","initnum":25,"hp":26,"atk":26,"def":26,"agi":17},
    {"name":"토로쟈","initnum":21,"hp":25,"atk":26,"def":25,"agi":16},
    {"name":"부르보","initnum":20,"hp":23,"atk":25,"def":24,"agi":20},
    {"name":"푸보","initnum":18,"hp":30,"atk":30,"def":22,"agi":16},
    {"name":"타루쟈","initnum":18,"hp":26,"atk":35,"def":21,"agi":16},
    {"name":"노보","initnum":22,"hp":26,"atk":26,"def":29,"agi":24},
    {"name":"카쿠","initnum":18,"hp":28,"atk":29,"def":25,"agi":32},
    {"name":"바카","initnum":20,"hp":19,"atk":27,"def":20,"agi":28},
    {"name":"바우","initnum":17,"hp":18,"atk":23,"def":20,"agi":28},
    {"name":"카우","initnum":17,"hp":16,"atk":23,"def":23,"agi":26},
    {"name":"바카우","initnum":18,"hp":21,"atk":30,"def":17,"agi":29},
    {"name":"바쿠우","initnum":18,"hp":30,"atk":34,"def":20,"agi":30},
    {"name":"푸쿠","initnum":18,"hp":21,"atk":31,"def":17,"agi":28},
    {"name":"바쿠","initnum":18,"hp":24,"atk":33,"def":21,"agi":29},
    {"name":"베르가","initnum":24,"hp":24,"atk":29,"def":14,"agi":26},
    {"name":"베루루","initnum":23,"hp":21,"atk":30,"def":13,"agi":28},
    {"name":"고르고르","initnum":21,"hp":20,"atk":31,"def":13,"agi":27},
    {"name":"노르노르","initnum":25,"hp":22,"atk":30,"def":17,"agi":29},
    {"name":"도르도르","initnum":23,"hp":25,"atk":31,"def":14,"agi":28},
    {"name":"성호","initnum":24,"hp":29,"atk":32,"def":13,"agi":29},
    {"name":"고루루","initnum":25,"hp":25,"atk":32,"def":13,"agi":28},
    {"name":"페루루","initnum":26,"hp":23,"atk":32,"def":13,"agi":29},
    {"name":"베라라","initnum":25,"hp":26,"atk":35,"def":15,"agi":32},
    {"name":"하르가","initnum":22,"hp":30,"atk":37,"def":16,"agi":31},
    {"name":"검호","initnum":26,"hp":26,"atk":34,"def":14,"agi":30},
    {"name":"천호","initnum":27,"hp":26,"atk":34,"def":12,"agi":28},
    {"name":"메카르노","initnum":24,"hp":30,"atk":41,"def":17,"agi":28},
    {"name":"토리노프스","initnum":12,"hp":26,"atk":21,"def":26,"agi":12},
    {"name":"펜타스","initnum":16,"hp":28,"atk":17,"def":28,"agi":11},
    {"name":"토리케라","initnum":18,"hp":27,"atk":18,"def":28,"agi":10},
    {"name":"토르프스","initnum":14,"hp":26,"atk":19,"def":29,"agi":9},
    {"name":"타노프스","initnum":16,"hp":38,"atk":24,"def":33,"agi":11},
    {"name":"노타스","initnum":14,"hp":34,"atk":26,"def":37,"agi":20},
    {"name":"코발스","initnum":15,"hp":40,"atk":25,"def":31,"agi":10},
    {"name":"타르프스","initnum":14,"hp":35,"atk":26,"def":42,"agi":11},
    {"name":"고반케스","initnum":20,"hp":27,"atk":33,"def":15,"agi":16},
    {"name":"쟈그라","initnum":20,"hp":26,"atk":34,"def":14,"agi":17},
    {"name":"쟈그","initnum":20,"hp":30,"atk":33,"def":13,"agi":17},
    {"name":"판지","initnum":20,"hp":29,"atk":33,"def":14,"agi":17},
    {"name":"석화케스","initnum":24,"hp":27,"atk":33,"def":15,"agi":17},
    {"name":"판그라","initnum":24,"hp":27,"atk":35,"def":15,"agi":19},
    {"name":"판그","initnum":23,"hp":28,"atk":34,"def":17,"agi":18},
    {"name":"쟈하드","initnum":24,"hp":24,"atk":34,"def":14,"agi":22},
    {"name":"메카케스","initnum":25,"hp":34,"atk":41,"def":18,"agi":24},
    {"name":"기가로스","initnum":28,"hp":30,"atk":34,"def":32,"agi":20},
    {"name":"메가로스","initnum":24,"hp":33,"atk":36,"def":33,"agi":13},
    {"name":"비트로스","initnum":25,"hp":30,"atk":37,"def":27,"agi":21},
    {"name":"가가로스","initnum":26,"hp":32,"atk":40,"def":27,"agi":15},
    {"name":"라가로스","initnum":24,"hp":38,"atk":30,"def":35,"agi":5},
    {"name":"기트로스","initnum":24,"hp":35,"atk":34,"def":31,"agi":5},
    {"name":"노트로스","initnum":26,"hp":36,"atk":33,"def":32,"agi":5},
    {"name":"돌가로스","initnum":26,"hp":32,"atk":30,"def":33,"agi":8},
    {"name":"루이","initnum":22,"hp":40,"atk":32,"def":33,"agi":10},
    {"name":"무이","initnum":20,"hp":44,"atk":30,"def":33,"agi":10},
    {"name":"씨보스","initnum":21,"hp":41,"atk":30,"def":35,"agi":10},
    {"name":"투이","initnum":24,"hp":39,"atk":34,"def":33,"agi":9},
    {"name":"누이","initnum":20,"hp":36,"atk":32,"def":38,"agi":10},
    {"name":"가이","initnum":20,"hp":46,"atk":33,"def":32,"agi":8},
    {"name":"루보스","initnum":20,"hp":39,"atk":32,"def":37,"agi":8},
    {"name":"노보스","initnum":20,"hp":36,"atk":34,"def":33,"agi":13},
    {"name":"다크무이","initnum":25,"hp":38,"atk":38,"def":33,"agi":6},
    {"name":"다이노","initnum":25,"hp":37,"atk":31,"def":34,"agi":6},
    {"name":"다이노스","initnum":26,"hp":46,"atk":30,"def":35,"agi":7},
    {"name":"프라키토스","initnum":24,"hp":35,"atk":35,"def":28,"agi":6},
    {"name":"스텐토스","initnum":28,"hp":45,"atk":32,"def":34,"agi":5},
    {"name":"프리토스","initnum":28,"hp":41,"atk":34,"def":33,"agi":11},
    {"name":"푸비토스","initnum":28,"hp":41,"atk":33,"def":38,"agi":8},
    {"name":"브라키오스","initnum":28,"hp":40,"atk":32,"def":39,"agi":8},
    {"name":"노라키토스","initnum":28,"hp":41,"atk":34,"def":36,"agi":10},
    {"name":"브라키우스","initnum":26,"hp":36,"atk":39,"def":33,"agi":6},
    {"name":"스텐토스","initnum":28,"hp":35,"atk":32,"def":34,"agi":5},
    {"name":"메카다이노","initnum":23,"hp":53,"atk":31,"def":35,"agi":6},
    {"name":"만모","initnum":25,"hp":47,"atk":26,"def":39,"agi":6},
    {"name":"만모르","initnum":24,"hp":45,"atk":32,"def":35,"agi":6},
    {"name":"마모나스","initnum":25,"hp":49,"atk":26,"def":37,"agi":6},
    {"name":"만모로스","initnum":25,"hp":50,"atk":28,"def":34,"agi":6},
    {"name":"메모스","initnum":25,"hp":48,"atk":27,"def":39,"agi":5},
    {"name":"푸모나스","initnum":25,"hp":53,"atk":26,"def":36,"agi":5},
    {"name":"만모드","initnum":25,"hp":45,"atk":28,"def":41,"agi":4},
    {"name":"실버로스","initnum":25,"hp":51,"atk":26,"def":37,"agi":6},
    {"name":"아이스만모","initnum":23,"hp":55,"atk":27,"def":36,"agi":4},
    {"name":"테라곤","initnum":26,"hp":24,"atk":31,"def":15,"agi":32},
    {"name":"카르곤","initnum":26,"hp":23,"atk":31,"def":13,"agi":30},
    {"name":"포이비스","initnum":24,"hp":27,"atk":34,"def":21,"agi":32},
    {"name":"도라비스","initnum":26,"hp":24,"atk":31,"def":14,"agi":33},
    {"name":"푸테라","initnum":26,"hp":27,"atk":32,"def":15,"agi":30},
    {"name":"실버라곤","initnum":26,"hp":30,"atk":34,"def":21,"agi":31},
    {"name":"테라돈","initnum":25,"hp":35,"atk":33,"def":16,"agi":32},
    {"name":"보르비스","initnum":25,"hp":31,"atk":38,"def":17,"agi":29},
    {"name":"골드테라곤","initnum":26,"hp":24,"atk":31,"def":16,"agi":32},
    {"name":"테라비스","initnum":25,"hp":28,"atk":35,"def":15,"agi":36},
    {"name":"메카비스","initnum":23,"hp":30,"atk":37,"def":12,"agi":37},
    {"name":"타키","initnum":20,"hp":19,"atk":22,"def":10,"agi":35},
    {"name":"쿠쿠","initnum":20,"hp":18,"atk":22,"def":10,"agi":36},
    {"name":"호르쿠","initnum":20,"hp":20,"atk":21,"def":12,"agi":34},
    {"name":"카키","initnum":20,"hp":17,"atk":23,"def":11,"agi":33},
    {"name":"타르쿠","initnum":20,"hp":20,"atk":22,"def":13,"agi":33},
    {"name":"푸타카","initnum":20,"hp":22,"atk":21,"def":12,"agi":34},
    {"name":"흑카키","initnum":18,"hp":23,"atk":24,"def":15,"agi":40},
    {"name":"쥬키","initnum":19,"hp":19,"atk":25,"def":10,"agi":32},
    {"name":"다르쿠","initnum":20,"hp":23,"atk":26,"def":8,"agi":36},
    {"name":"오가로스","initnum":24,"hp":30,"atk":37,"def":28,"agi":20},
    {"name":"오르곤","initnum":26,"hp":33,"atk":38,"def":22,"agi":24},
    {"name":"모가로스","initnum":25,"hp":27,"atk":40,"def":19,"agi":28},
    {"name":"골로스","initnum":26,"hp":28,"atk":40,"def":21,"agi":25},
    {"name":"칼로스","initnum":25,"hp":26,"atk":35,"def":17,"agi":26},
    {"name":"지가로스","initnum":25,"hp":27,"atk":34,"def":22,"agi":21},
    {"name":"푸룡","initnum":25,"hp":31,"atk":40,"def":18,"agi":28},
    {"name":"흑귀","initnum":26,"hp":30,"atk":42,"def":18,"agi":25},
    {"name":"카르노스","initnum":25,"hp":28,"atk":39,"def":20,"agi":28},
    {"name":"노르곤","initnum":26,"hp":27,"atk":38,"def":17,"agi":27},
    {"name":"로제로스","initnum":24,"hp":27,"atk":40,"def":16,"agi":30},
    {"name":"파베로스","initnum":24,"hp":28,"atk":38,"def":15,"agi":33},
    {"name":"카가로스","initnum":25,"hp":26,"atk":40,"def":14,"agi":23},
    {"name":"암흑골로스","initnum":26,"hp":24,"atk":37,"def":16,"agi":26},
    {"name":"주로스","initnum":24,"hp":29,"atk":41,"def":21,"agi":25},
    {"name":"아르로스","initnum":25,"hp":31,"atk":42,"def":22,"agi":23},
    {"name":"다크로스","initnum":25,"hp":29,"atk":43,"def":21,"agi":24},
    {"name":"그린바로스","initnum":23,"hp":32,"atk":44,"def":18,"agi":24},
    {"name":"바로스","initnum":24,"hp":29,"atk":39,"def":17,"agi":31},
    {"name":"설곤","initnum":25,"hp":30,"atk":42,"def":15,"agi":29},
    {"name":"프이토","initnum":26,"hp":19,"atk":22,"def":25,"agi":29},
    {"name":"모나시프","initnum":25,"hp":23,"atk":23,"def":24,"agi":28},
    {"name":"라나프","initnum":28,"hp":18,"atk":26,"def":24,"agi":29},
    {"name":"라이혼","initnum":26,"hp":26,"atk":34,"def":25,"agi":32},
    {"name":"타이혼","initnum":26,"hp":24,"atk":36,"def":22,"agi":33},
    {"name":"차이혼","initnum":28,"hp":28,"atk":28,"def":25,"agi":34},
    {"name":"파라프","initnum":28,"hp":27,"atk":27,"def":24,"agi":36},
    {"name":"모이토","initnum":27,"hp":22,"atk":26,"def":29,"agi":32},
    {"name":"타이혼","initnum":26,"hp":24,"atk":36,"def":22,"agi":33},
    {"name":"메카타이혼","initnum":22,"hp":29,"atk":38,"def":16,"agi":33},
    {"name":"스토라지","initnum":21,"hp":35,"atk":26,"def":23,"agi":20},
    {"name":"아토라지","initnum":20,"hp":39,"atk":29,"def":24,"agi":23},
    {"name":"아리노스","initnum":26,"hp":34,"atk":26,"def":25,"agi":19},
    {"name":"다이노로스","initnum":24,"hp":36,"atk":32,"def":23,"agi":25},
    {"name":"타르노로스","initnum":23,"hp":40,"atk":31,"def":24,"agi":24},
    {"name":"노리노스","initnum":23,"hp":34,"atk":26,"def":32,"agi":27},
    {"name":"푸토라지","initnum":23,"hp":38,"atk":26,"def":31,"agi":20},
    {"name":"코리노로스","initnum":26,"hp":30,"atk":32,"def":28,"agi":28},
    {"name":"바로로크스","initnum":22,"hp":24,"atk":19,"def":24,"agi":18},
    {"name":"란베르스","initnum":21,"hp":26,"atk":21,"def":21,"agi":22},
    {"name":"코리토르스","initnum":19,"hp":24,"atk":20,"def":22,"agi":20},
    {"name":"노스토로스","initnum":23,"hp":22,"atk":25,"def":20,"agi":24},
    {"name":"노로로크스","initnum":23,"hp":26,"atk":29,"def":22,"agi":27},
    {"name":"실버로크스","initnum":25,"hp":29,"atk":30,"def":23,"agi":25},
    {"name":"디로로크스","initnum":24,"hp":25,"atk":28,"def":21,"agi":28},
    {"name":"진주토로스","initnum":24,"hp":30,"atk":27,"def":22,"agi":20},
    {"name":"황호","initnum":25,"hp":27,"atk":37,"def":18,"agi":31},
    {"name":"청호","initnum":25,"hp":29,"atk":39,"def":20,"agi":27},
    {"name":"흑호","initnum":25,"hp":28,"atk":35,"def":16,"agi":35},
    {"name":"이블티거","initnum":25,"hp":24,"atk":35,"def":14,"agi":25},
    {"name":"백호","initnum":24,"hp":31,"atk":42,"def":21,"agi":23},
    {"name":"로데오","initnum":24,"hp":29,"atk":41,"def":18,"agi":28},
    {"name":"가우","initnum":25,"hp":30,"atk":40,"def":19,"agi":28},
    {"name":"포루나","initnum":23,"hp":27,"atk":31,"def":13,"agi":30},
    {"name":"피피아","initnum":23,"hp":24,"atk":29,"def":14,"agi":29},
    {"name":"사루나","initnum":23,"hp":21,"atk":26,"def":10,"agi":35},
    {"name":"포레스트크랩","initnum":24,"hp":43,"atk":32,"def":36,"agi":5},
    {"name":"크랩","initnum":21,"hp":33,"atk":36,"def":26,"agi":21},
    {"name":"핑크랩","initnum":25,"hp":34,"atk":36,"def":32,"agi":5},
    {"name":"킹크랩","initnum":21,"hp":40,"atk":38,"def":34,"agi":6},
    {"name":"스톤크랩","initnum":24,"hp":38,"atk":32,"def":40,"agi":4},
    {"name":"지라크","initnum":23,"hp":30,"atk":27,"def":17,"agi":29},
    {"name":"타이판","initnum":23,"hp":25,"atk":33,"def":17,"agi":19},
    {"name":"파이톤","initnum":23,"hp":26,"atk":36,"def":17,"agi":24},
    {"name":"바이퍼","initnum":24,"hp":25,"atk":34,"def":16,"agi":28},
    {"name":"포보스","initnum":24,"hp":26,"atk":33,"def":24,"agi":21},
    {"name":"아코로비","initnum":25,"hp":31,"atk":38,"def":19,"agi":27},
    {"name":"골드로비","initnum":26,"hp":22,"atk":29,"def":14,"agi":28},
    {"name":"토라","initnum":26,"hp":21,"atk":26,"def":12,"agi":26},
    {"name":"페르페","initnum":26,"hp":23,"atk":25,"def":11,"agi":24},
    {"name":"슈우","initnum":26,"hp":21,"atk":29,"def":17,"agi":14},
    {"name":"미니스","initnum":26,"hp":23,"atk":28,"def":12,"agi":24},
    {"name":"발로스","initnum":22,"hp":27,"atk":39,"def":16,"agi":29},
    {"name":"데블로스","initnum":21,"hp":24,"atk":32,"def":13,"agi":29},
    {"name":"스노밍코","initnum":20,"hp":30,"atk":22,"def":20,"agi":33},
    {"name":"밍코","initnum":19,"hp":30,"atk":34,"def":11,"agi":31},
    {"name":"링코","initnum":22,"hp":43,"atk":30,"def":14,"agi":33},
    {"name":"한복밍코","initnum":26,"hp":26,"atk":34,"def":14,"agi":34},
    {"name":"쿠아","initnum":24,"hp":23,"atk":29,"def":16,"agi":25},
    {"name":"쿠팡","initnum":23,"hp":19,"atk":30,"def":10,"agi":27},
    {"name":"크루거","initnum":24,"hp":30,"atk":35,"def":17,"agi":33},
    {"name":"카우거","initnum":25,"hp":29,"atk":39,"def":14,"agi":33},
    {"name":"볼케","initnum":24,"hp":27,"atk":38,"def":15,"agi":33},
    {"name":"이구로스","initnum":25,"hp":27,"atk":35,"def":18,"agi":29},
    {"name":"기로아치","initnum":24,"hp":30,"atk":40,"def":16,"agi":28},
    {"name":"크로아치","initnum":23,"hp":30,"atk":39,"def":21,"agi":25},
    {"name":"마루아치","initnum":26,"hp":28,"atk":40,"def":18,"agi":23},
    {"name":"도에디크","initnum":27,"hp":30,"atk":34,"def":32,"agi":13},
    {"name":"레이론","initnum":24,"hp":26,"atk":34,"def":19,"agi":20},
    {"name":"샤크론","initnum":24,"hp":32,"atk":37,"def":15,"agi":33},
    {"name":"다크론","initnum":24,"hp":33,"atk":41,"def":20,"agi":24},
    {"name":"차크론","initnum":24,"hp":26,"atk":34,"def":11,"agi":28},
    {"name":"아크론","initnum":25,"hp":32,"atk":38,"def":14,"agi":33},
    {"name":"마크론","initnum":24,"hp":28,"atk":42,"def":17,"agi":28},
    {"name":"치크론","initnum":23,"hp":27,"atk":37,"def":13,"agi":32},
    {"name":"디메트로돈","initnum":23,"hp":42,"atk":33,"def":38,"agi":3},
    {"name":"비트로돈","initnum":22,"hp":29,"atk":35,"def":27,"agi":23},
    {"name":"갈푸스","initnum":24,"hp":27,"atk":40,"def":14,"agi":33},
    {"name":"델푸스","initnum":24,"hp":24,"atk":33,"def":12,"agi":25},
    {"name":"흑갈푸스","initnum":22,"hp":27,"atk":39,"def":15,"agi":33},
    {"name":"롤프","initnum":24,"hp":28,"atk":40,"def":16,"agi":31},
    {"name":"아르마루","initnum":25,"hp":28,"atk":37,"def":17,"agi":27},
    {"name":"베르마루","initnum":27,"hp":27,"atk":36,"def":15,"agi":25},
    {"name":"구루마루","initnum":25,"hp":30,"atk":40,"def":17,"agi":29},
    {"name":"헤르마루","initnum":23,"hp":29,"atk":41,"def":16,"agi":29},
    {"name":"부루마루","initnum":25,"hp":31,"atk":41,"def":16,"agi":29},
    {"name":"가르마루","initnum":24,"hp":30,"atk":41,"def":18,"agi":28},
    {"name":"호르카","initnum":25,"hp":25,"atk":28,"def":18,"agi":25},
    {"name":"펠트르돈","initnum":26,"hp":27,"atk":35,"def":17,"agi":22},
    {"name":"델타르돈","initnum":23,"hp":27,"atk":33,"def":22,"agi":22},
    {"name":"카르카로돈","initnum":23,"hp":25,"atk":32,"def":15,"agi":27},
    {"name":"푸타푸타","initnum":25,"hp":23,"atk":29,"def":12,"agi":33},
    {"name":"후바티","initnum":23,"hp":33,"atk":39,"def":24,"agi":22},
    {"name":"노바티","initnum":21,"hp":28,"atk":39,"def":21,"agi":27},
    {"name":"키파","initnum":25,"hp":24,"atk":33,"def":15,"agi":26},
    {"name":"히파","initnum":24,"hp":26,"atk":33,"def":10,"agi":39,"rank":455},
    {"name":"테로노돈","initnum":25,"hp":27,"atk":30,"def":12,"agi":33},
    {"name":"익시노돈","initnum":26,"hp":24,"atk":29,"def":11,"agi":33},
    {"name":"샤베르","initnum":24,"hp":25,"atk":31,"def":14,"agi":28},
    {"name":"타키온","initnum":24,"hp":27,"atk":29,"def":12,"agi":26},
    {"name":"라이쿠스","initnum":24,"hp":43,"atk":33,"def":38,"agi":6},
    {"name":"바라쿠스","initnum":24,"hp":42,"atk":31,"def":39,"agi":7},
    {"name":"헤라쿠스","initnum":22,"hp":42,"atk":33,"def":37,"agi":5},
    {"name":"타이쿠스","initnum":23,"hp":42,"atk":37,"def":37,"agi":3},
    {"name":"어린흑룡","initnum":26,"hp":25,"atk":33,"def":13,"agi":29},
    {"name":"어린백룡","initnum":24,"hp":25,"atk":30,"def":15,"agi":25},
    {"name":"어린청룡","initnum":26,"hp":36,"atk":43,"def":14,"agi":22},
    {"name":"메피노","initnum":25,"hp":30,"atk":41,"def":19,"agi":26},
    {"name":"스피노","initnum":26,"hp":29,"atk":43,"def":17,"agi":26},
    {"name":"야크노","initnum":26,"hp":25,"atk":35,"def":17,"agi":22},
    {"name":"엘피노","initnum":25,"hp":28,"atk":40,"def":19,"agi":22},
    {"name":"흑주작","initnum":24,"hp":25,"atk":36,"def":13,"agi":25},
    {"name":"아스타로","initnum":23,"hp":27,"atk":35,"def":11,"agi":41},
    {"name":"어린주작","initnum":28,"hp":22,"atk":28,"def":10,"agi":26},
    {"name":"어린청주작","initnum":27,"hp":20,"atk":26,"def":8,"agi":27},
    {"name":"흑풍","initnum":25,"hp":29,"atk":38,"def":14,"agi":34},
    {"name":"어린풍백","initnum":33,"hp":21,"atk":26,"def":10,"agi":25},
    {"name":"메카청룡","initnum":25,"hp":34,"atk":42,"def":15,"agi":28},
    {"name":"흑기린","initnum":24,"hp":26,"atk":40,"def":18,"agi":19},
    {"name":"기린","initnum":24,"hp":30,"atk":41,"def":21,"agi":22},
    {"name":"기란","initnum":24,"hp":28,"atk":38,"def":20,"agi":22},
    {"name":"백기린","initnum":24,"hp":32,"atk":43,"def":21,"agi":21},
    {"name":"우라노스","initnum":27,"hp":23,"atk":29,"def":11,"agi":26},
    {"name":"불카노스","initnum":24,"hp":27,"atk":38,"def":15,"agi":33},
    {"name":"헬노스","initnum":23,"hp":28,"atk":38,"def":11,"agi":38},
    {"name":"아비시니안","initnum":26,"hp":23,"atk":31,"def":14,"agi":25},
    {"name":"바우트","initnum":26,"hp":38,"atk":39,"def":36,"agi":4},
    {"name":"토우트","initnum":26,"hp":45,"atk":34,"def":36,"agi":7},
    {"name":"타우트","initnum":27,"hp":40,"atk":38,"def":36,"agi":4},
    {"name":"샤우트","initnum":25,"hp":44,"atk":35,"def":35,"agi":9},
    {"name":"모사크","initnum":23,"hp":32,"atk":40,"def":17,"agi":28},
    {"name":"디사크","initnum":22,"hp":30,"atk":42,"def":17,"agi":28},
    {"name":"블랙펄","initnum":25,"hp":25,"atk":35,"def":14,"agi":29},
    {"name":"블루문","initnum":25,"hp":30,"atk":39,"def":17,"agi":28},
    {"name":"쿠오코마","initnum":26,"hp":39,"atk":36,"def":31,"agi":9},
    {"name":"웅이","initnum":26,"hp":42,"atk":35,"def":33,"agi":8},
    {"name":"흑토끼","initnum":24,"hp":28,"atk":36,"def":22,"agi":18},
    {"name":"백설토끼","initnum":24,"hp":43,"atk":33,"def":37,"agi":4},
    {"name":"어린현무","initnum":24,"hp":47,"atk":29,"def":37,"agi":6},
    {"name":"야무리","initnum":27,"hp":30,"atk":34,"def":10,"agi":20},
    {"name":"둠바로스","initnum":24,"hp":39,"atk":39,"def":33,"agi":4},
    {"name":"케라스","initnum":26,"hp":32,"atk":41,"def":21,"agi":23},
    {"name":"쿠라스","initnum":26,"hp":29,"atk":39,"def":13,"agi":34},
    {"name":"한가름","initnum":25,"hp":32,"atk":42,"def":16,"agi":28},
    {"name":"막쿠마","initnum":24,"hp":26,"atk":34,"def":9,"agi":39},
    {"name":"자쿠이노","initnum":26,"hp":35,"atk":39,"def":26,"agi":19},
    {"name":"페리스","initnum":24,"hp":38,"atk":37,"def":30,"agi":4},
    {"name":"깜아리","initnum":22,"hp":32,"atk":38,"def":13,"agi":33},
    {"name":"홍아리","initnum":24,"hp":21,"atk":29,"def":11,"agi":35},
    {"name":"펭펭","initnum":26,"hp":29,"atk":37,"def":20,"agi":23},
    {"name":"흑돌","initnum":25,"hp":33,"atk":38,"def":22,"agi":23},
    {"name":"팽돌","initnum":24,"hp":42,"atk":37,"def":33,"agi":4},
    {"name":"돌핀","initnum":26,"hp":28,"atk":41,"def":17,"agi":28},
    {"name":"델피누스","initnum":24,"hp":25,"atk":30,"def":12,"agi":32},
    {"name":"엘피누스","initnum":25,"hp":23,"atk":31,"def":11,"agi":33},
    {"name":"셀르프","initnum":24,"hp":37,"atk":32,"def":34,"agi":5},
    {"name":"봉봉","initnum":26,"hp":30,"atk":41,"def":19,"agi":26},
    {"name":"라이칸","initnum":25,"hp":24,"atk":34,"def":17,"agi":19},
    {"name":"나비드래곤","initnum":25,"hp":29,"atk":39,"def":15,"agi":32},
    {"name":"블랙드래곤","initnum":25,"hp":28,"atk":42,"def":16,"agi":29},
    {"name":"어린골드드래곤","initnum":24,"hp":26,"atk":34,"def":10,"agi":40},
    {"name":"어린아이스드래곤","initnum":28,"hp":25,"atk":33,"def":11,"agi":21},
    {"name":"어린어스드래곤","initnum":24,"hp":32,"atk":41,"def":17,"agi":22},
    {"name":"어린레드드래곤","initnum":24,"hp":28,"atk":41,"def":13,"agi":28},
    {"name":"한복메이","initnum":26,"hp":27,"atk":39,"def":19,"agi":23},
    {"name":"베이클","initnum":24,"hp":29,"atk":39,"def":18,"agi":23},
    {"name":"각수","initnum":25,"hp":28,"atk":38,"def":16,"agi":27},
    {"name":"격수","initnum":23,"hp":30,"atk":40,"def":17,"agi":28},
    {"name":"싸이클론","initnum":24,"hp":30,"atk":39,"def":28,"agi":19},
    {"name":"타르톤","initnum":26,"hp":38,"atk":37,"def":37,"agi":4},
    {"name":"밤미","initnum":25,"hp":27,"atk":34,"def":15,"agi":37},
    {"name":"아누","initnum":24,"hp":25,"atk":33,"def":14,"agi":29},
    {"name":"카누","initnum":24,"hp":26,"atk":34,"def":14,"agi":28},
    {"name":"토로카","initnum":23,"hp":30,"atk":42,"def":20,"agi":24},
    {"name":"아르카","initnum":24,"hp":25,"atk":34,"def":13,"agi":30},
    {"name":"메이","initnum":24,"hp":25,"atk":33,"def":14,"agi":31},
    {"name":"토르","initnum":23,"hp":32,"atk":39,"def":22,"agi":25},
    {"name":"문울프","initnum":25,"hp":29,"atk":36,"def":16,"agi":33},
    {"name":"다크울프","initnum":23,"hp":28,"atk":38,"def":15,"agi":32},
    {"name":"번울프","initnum":25,"hp":26,"atk":37,"def":16,"agi":30},
    {"name":"다크야무","initnum":25,"hp":37,"atk":40,"def":31,"agi":5},
    {"name":"라그노스","initnum":25,"hp":41,"atk":39,"def":34,"agi":4},
    {"name":"크로톤","initnum":25,"hp":33,"atk":40,"def":20,"agi":25},
    {"name":"타우루스","initnum":22,"hp":40,"atk":35,"def":37,"agi":6},
    {"name":"크라우","initnum":25,"hp":28,"atk":38,"def":16,"agi":27},
    {"name":"싸가트","initnum":25,"hp":30,"atk":43,"def":17,"agi":26},
    {"name":"파사트","initnum":25,"hp":28,"atk":38,"def":17,"agi":21},
    {"name":"플라티우스","initnum":25,"hp":28,"atk":29,"def":13,"agi":20},
    {"name":"프라미우스","initnum":25,"hp":24,"atk":28,"def":15,"agi":23},
    {"name":"아마란","initnum":25,"hp":27,"atk":31,"def":11,"agi":25},
    {"name":"고오다","initnum":25,"hp":23,"atk":29,"def":8,"agi":32},
    {"name":"로즈란","initnum":25,"hp":26,"atk":34,"def":12,"agi":21},
    {"name":"로오다","initnum":25,"hp":23,"atk":25,"def":7,"agi":31},
    {"name":"스켈렉스","initnum":25,"hp":30,"atk":43,"def":20,"agi":23},
    {"name":"스켈록스","initnum":26,"hp":24,"atk":39,"def":16,"agi":20},
    {"name":"본드래곤","initnum":25,"hp":31,"atk":42,"def":16,"agi":28},
    {"name":"우마왕","initnum":23,"hp":30,"atk":39,"def":28,"agi":19},
    {"name":"흑마왕","initnum":23,"hp":31,"atk":39,"def":20,"agi":28},
    {"name":"마그노","initnum":23,"hp":32,"atk":34,"def":16,"agi":21},
    {"name":"머그노","initnum":22,"hp":29,"atk":36,"def":17,"agi":21},
    {"name":"푸로비","initnum":26,"hp":26,"atk":35,"def":12,"agi":31},
    {"name":"화이트쟈그","initnum":24,"hp":42,"atk":35,"def":35,"agi":8},
    {"name":"산타베르가","initnum":25,"hp":29,"atk":39,"def":15,"agi":33},
    {"name":"리바이어던","initnum":24,"hp":53,"atk":30,"def":34,"agi":5},
    {"name":"만모베베","initnum":25,"hp":43,"atk":38,"def":31,"agi":7},
    {"name":"크람푸스","initnum":23,"hp":29,"atk":39,"def":15,"agi":33},
    {"name":"만모링","initnum":23,"hp":32,"atk":41,"def":23,"agi":20},
    {"name":"산타로스","initnum":23,"hp":38,"atk":37,"def":35,"agi":7},
    {"name":"링코링","initnum":17,"hp":27,"atk":30,"def":20,"agi":27},
    {"name":"프로스비","initnum":22,"hp":30,"atk":40,"def":17,"agi":27},
    {"name":"산타링코","initnum":23,"hp":28,"atk":31,"def":26,"agi":32},
    {"name":"킹라쿠","initnum":24,"hp":23,"atk":29,"def":12,"agi":34},
    {"name":"차란라쿠","initnum":24,"hp":22,"atk":28,"def":12,"agi":34},
    {"name":"칼란라쿠","initnum":24,"hp":23,"atk":26,"def":12,"agi":32},
    {"name":"메이밍","initnum":26,"hp":26,"atk":35,"def":15,"agi":32},
    {"name":"킹꼬미","initnum":24,"hp":28,"atk":39,"def":15,"agi":27},
    {"name":"체루루","initnum":26,"hp":26,"atk":36,"def":13,"agi":32},
    {"name":"해태","initnum":24,"hp":30,"atk":39,"def":22,"agi":25},
    {"name":"해치","initnum":25,"hp":25,"atk":33,"def":14,"agi":31},
    {"name":"도철","initnum":24,"hp":31,"atk":41,"def":20,"agi":24},
    {"name":"아리","initnum":24,"hp":22,"atk":28,"def":11,"agi":36},
    {"name":"테이노스","initnum":23,"hp":35,"atk":42,"def":19,"agi":24},
    {"name":"백여우","initnum":25,"hp":27,"atk":36,"def":16,"agi":25},
    {"name":"메카카키","initnum":17,"hp":26,"atk":32,"def":12,"agi":45},
    {"name":"지룡","initnum":25,"hp":29,"atk":41,"def":19,"agi":27},
    {"name":"하트링","initnum":22,"hp":25,"atk":28,"def":17,"agi":31},
    {"name":"노론","initnum":25,"hp":28,"atk":39,"def":19,"agi":22},
    {"name":"피노","initnum":22,"hp":29,"atk":41,"def":16,"agi":28},
    {"name":"라피노","initnum":25,"hp":32,"atk":41,"def":18,"agi":25},
    {"name":"글루밍","initnum":22,"hp":26,"atk":36,"def":15,"agi":30},
    {"name":"글루문","initnum":22,"hp":29,"atk":39,"def":17,"agi":29},
    {"name":"바쿰","initnum":26,"hp":43,"atk":34,"def":35,"agi":6},
    {"name":"흑뱀","initnum":24,"hp":30,"atk":38,"def":17,"agi":32},
    {"name":"풍뱀","initnum":25,"hp":26,"atk":30,"def":14,"agi":35},
    {"name":"불뱀","initnum":25,"hp":26,"atk":35,"def":15,"agi":24},
    {"name":"물뱀","initnum":25,"hp":28,"atk":34,"def":17,"agi":21},
    {"name":"땅뱀","initnum":25,"hp":28,"atk":36,"def":17,"agi":24},
    {"name":"동가리","initnum":24,"hp":26,"atk":33,"def":14,"agi":29},
    {"name":"둥가리","initnum":24,"hp":25,"atk":33,"def":13,"agi":31},
    {"name":"팽팽","initnum":22,"hp":31,"atk":28,"def":45,"agi":3},
    {"name":"헷지","initnum":24,"hp":40,"atk":33,"def":36,"agi":8},
    {"name":"크로커","initnum":24,"hp":33,"atk":40,"def":21,"agi":24},
    {"name":"크로그","initnum":24,"hp":29,"atk":41,"def":22,"agi":23},
    {"name":"크토돈","initnum":24,"hp":29,"atk":43,"def":15,"agi":28},
    {"name":"노아돈","initnum":24,"hp":27,"atk":44,"def":16,"agi":27},
    {"name":"루비","initnum":23,"hp":40,"atk":39,"def":33,"agi":5},
    {"name":"바이론","initnum":23,"hp":31,"atk":42,"def":21,"agi":22},
    {"name":"헬베로스","initnum":24,"hp":28,"atk":42,"def":14,"agi":30},
    {"name":"엘베로스","initnum":23,"hp":31,"atk":41,"def":15,"agi":31},
    {"name":"켈베로스","initnum":23,"hp":33,"atk":41,"def":15,"agi":30},
    {"name":"복덩이","initnum":25,"hp":44,"atk":34,"def":36,"agi":8},
    {"name":"타무르","initnum":25,"hp":30,"atk":45,"def":18,"agi":24},
    {"name":"리어룬","initnum":24,"hp":29,"atk":41,"def":18,"agi":29},
    {"name":"시어룬","initnum":24,"hp":25,"atk":34,"def":12,"agi":28},
    {"name":"디어룬","initnum":23,"hp":28,"atk":37,"def":12,"agi":38},
    {"name":"카라고니스","initnum":25,"hp":24,"atk":32,"def":14,"agi":33},
    {"name":"트라고니스","initnum":19,"hp":28,"atk":32,"def":13,"agi":43},
    {"name":"티렉스","initnum":25,"hp":28,"atk":39,"def":16,"agi":26},
    {"name":"라우렉스","initnum":25,"hp":29,"atk":42,"def":16,"agi":28},
    {"name":"밴더스네처","initnum":25,"hp":34,"atk":42,"def":24,"agi":19},
    {"name":"미도미도","initnum":24,"hp":27,"atk":37,"def":16,"agi":24},
    {"name":"코도코도","initnum":25,"hp":27,"atk":36,"def":18,"agi":23},
    {"name":"피도피도","initnum":25,"hp":25,"atk":38,"def":17,"agi":23},
    {"name":"코무시","initnum":22,"hp":48,"atk":32,"def":36,"agi":3},
    {"name":"코르코","initnum":23,"hp":50,"atk":29,"def":37,"agi":3},
    {"name":"베르고","initnum":23,"hp":34,"atk":42,"def":27,"agi":16},
    {"name":"닉스","initnum":23,"hp":28,"atk":37,"def":12,"agi":38},
    {"name":"지발리","initnum":24,"hp":45,"atk":35,"def":38,"agi":4},
    {"name":"파르체","initnum":24,"hp":34,"atk":41,"def":16,"agi":29},
    {"name":"샤르체","initnum":24,"hp":31,"atk":45,"def":17,"agi":25},
    {"name":"슈발리","initnum":24,"hp":30,"atk":40,"def":14,"agi":33},
    {"name":"나노티라노스","initnum":24,"hp":29,"atk":39,"def":14,"agi":34},
    {"name":"도라오닉스","initnum":24,"hp":28,"atk":38,"def":11,"agi":39},
    {"name":"헤머드","initnum":23,"hp":33,"atk":44,"def":18,"agi":24},
    {"name":"티라누스","initnum":24,"hp":30,"atk":43,"def":14,"agi":29},
    {"name":"마그북","initnum":25,"hp":39,"atk":36,"def":37,"agi":4},
    {"name":"가루다","initnum":25,"hp":24,"atk":33,"def":14,"agi":32},
    {"name":"라이비","initnum":24,"hp":27,"atk":36,"def":12,"agi":38},
    {"name":"베라냐","initnum":25,"hp":27,"atk":39,"def":15,"agi":23},
    {"name":"프리쉴라","initnum":26,"hp":23,"atk":33,"def":15,"agi":23},
    {"name":"프리벨라","initnum":28,"hp":22,"atk":34,"def":14,"agi":24},
    {"name":"루토","initnum":23,"hp":30,"atk":37,"def":30,"agi":19},
    {"name":"블리","initnum":27,"hp":35,"atk":39,"def":24,"agi":20},
    {"name":"레디","initnum":24,"hp":43,"atk":40,"def":30,"agi":5},
    {"name":"옐로비","initnum":24,"hp":29,"atk":34,"def":15,"agi":37},
    {"name":"아르체","initnum":27,"hp":31,"atk":41,"def":18,"agi":27},
    {"name":"물범","initnum":23,"hp":45,"atk":37,"def":33,"agi":4},
];

/* ========= 상수 ========= */
const TOTAL = 178750;

/* ========= 전역 ========= */
let GLOBAL_TABLE = {};
let ALL_NAMES = [];
let R8MAP = {}; // Rank8 맵은 현재 사용하지 않으므로 비워둡니다.

/* ========= 유틸 ========= */
function fmtPct(x){
  if(!Number.isFinite(x)) return "—%";
  if(x === 0) return "0.0000%";
  if(x < 0.001) return x.toFixed(6) + "%";
  return x.toFixed(4) + "%";
}

/* ========= 초성(문자 → 초성) 유틸 ========= */
const CHO_CODE = ['ㄱ','ㄲ','ㄴ','ㄷ','ㄸ','ㄹ','ㅁ','ㅂ','ㅃ','ㅅ','ㅆ','ㅇ','ㅈ','ㅉ','ㅊ','ㅋ','ㅌ','ㅍ','ㅎ'];
const CHO_SIMPLE = (c)=>({"ㄲ":"ㄱ","ㄸ":"ㄷ","ㅃ":"ㅂ","ㅆ":"ㅅ","ㅉ":"ㅈ"}[c]||c);
function getChosung(str){
  let out="";
  for(const ch of str){
    const code = ch.charCodeAt(0);
    if(code<0xAC00 || code>0xD7A3){ out+=ch; continue; }
    const idx = Math.floor((code - 0xAC00) / 588);
    out += CHO_SIMPLE(CHO_CODE[idx]);
  }
  return out;
}

/* ========= 데이터 변환 및 로드 ========= */
function getRank(p) {
    if (p.rank) return p.rank;
    const totalStats = p.hp + p.atk + p.def + p.agi;
    if (totalStats >= 110) return 435;
    if (totalStats >= 105) return 455;
    if (totalStats >= 100) return 475;
    if (totalStats >= 95) return 495;
    if (totalStats >= 90) return 515;
    if (totalStats >= 85) return 535;
    if (totalStats >= 80) return 555;
    return 575;
}

function calculateS0(k, u) {
    const preciseRound = (num) => Math.round(num * 1e12) / 1e12;
    const fac = k / 100;
    // 꼬비아빠 계산기 로직: base(+2)와 bonus(+2.5)를 더한 +4.5를 적용
    const vhp  = (u.hp + 4.5) * fac;
    const vatk = (u.atk+ 4.5) * fac;
    const vdef = (u.def+ 4.5) * fac;
    const vagi = (u.agi+ 4.5) * fac;

    const hp  = preciseRound(vhp);
    const atk = preciseRound(vatk);
    const def = preciseRound(vdef);
    const agi = preciseRound(vagi);

    return {
        hp: preciseRound((hp * 4) + atk + def + agi),
        atk: preciseRound((hp * 0.1) + atk + (def * 0.1) + (agi * 0.05)),
        def: preciseRound((hp * 0.1) + (atk * 0.1) + def + (agi * 0.05)),
        agi: preciseRound(agi)
    };
}

function calculateSg(u, e) {
    const preciseRound = (num) => Math.round(num * 1e12) / 1e12;
    const f = e / 10000;
    // 꼬비아빠 계산기 로직: base(+2)와 bonus(+2.5)를 더한 +4.5를 적용
    const u_hp = u.hp + 4.5;
    const u_atk = u.atk + 4.5;
    const u_def = u.def + 4.5;
    const u_agi = u.agi + 4.5;

    const upHp  = preciseRound(u_hp  * f);
    const upAtk = preciseRound(u_atk * f);
    const upDef = preciseRound(u_def * f);
    const upAgi = preciseRound(u_agi * f);

    return {
        hp:  preciseRound((upHp * 4) + upAtk + upDef + upAgi),
        atk: preciseRound((upHp * 0.1) + upAtk + (upDef * 0.1) + (upAgi * 0.05)),
        def: preciseRound((upHp * 0.1) + (upAtk * 0.1) + upDef + (upAgi * 0.05)),
        agi: preciseRound(upAgi)
    };
}

function buildPetTable() {
    GLOBAL_TABLE = {};
    for (const p of kkobyPetData) {
        // u는 순수 성장률
        const u = { hp: p.hp, atk: p.atk, def: p.def, agi: p.agi };
        const k = p.initnum;
        const e = getRank(p);
        // s0와 sg는 S펫 기준(+4.5)으로 계산하여 UI에 표시
        const s0 = calculateS0(k, u);
        const sg = calculateSg(u, e);
        // GLOBAL_TABLE에는 계산 엔진이 사용할 순수 u값과, UI에 표시할 s0, sg를 저장
        GLOBAL_TABLE[p.name] = { k, u, s0, sg };
    }
    ALL_NAMES = Object.keys(GLOBAL_TABLE).sort((a,b)=>a.localeCompare(b,'ko'));
}


/* ========= DOM ========= */
const chosungBar = document.getElementById('chosung');
const chosungTokens = document.getElementById('chosungTokens');
const petList = document.getElementById('petList');
const petSearch = document.getElementById('petSearch');
const s0hp = document.getElementById('s0_hp'), s0atk= document.getElementById('s0_atk'), s0def= document.getElementById('s0_def'), s0agi= document.getElementById('s0_agi');
const sghp = document.getElementById('sg_hp'), sgatk= document.getElementById('sg_atk'), sgdef= document.getElementById('sg_def'), sgagi= document.getElementById('sg_agi');
const obshp = document.getElementById('obs_hp'), obsatk= document.getElementById('obs_atk'), obsdef= document.getElementById('obs_def'), obsagi= document.getElementById('obs_agi');
const kpiSuccess = document.getElementById('kpiSuccess'), kpiAppear  = document.getElementById('kpiAppear'), kpiTries = document.getElementById('kpiTries');
const ringSuccess= document.getElementById('ringSuccess'), ringAppear = document.getElementById('ringAppear');
const totMatches = document.getElementById('totMatches'), rank8Matches = document.getElementById('rank8Matches');
const distBox = document.getElementById('dist');
const btnCalc = document.getElementById('btnCalc'), btnReset= document.getElementById('btnReset'), btnClear= document.getElementById('btnClear');

let currentChosung="", selectedName=null, selectedRow=null, selectedItemEl=null;

/* ========= 초성 키패드 ========= */
const CHO = ['ㄱ','ㄴ','ㄷ','ㄹ','ㅁ','ㅂ','ㅅ','ㅇ','ㅈ','ㅊ','ㅋ','ㅌ','ㅍ','ㅎ'];
function renderChosungTokens(){
  chosungTokens.innerHTML = "";
  for(const ch of currentChosung){
    const t = document.createElement('div');
    t.className = 'chip'; t.style.cursor = 'default'; t.textContent = ch;
    chosungTokens.appendChild(t);
  }
}
CHO.forEach(c=>{
  const chip=document.createElement('div');
  chip.className='chip'; chip.textContent=c;
  chip.addEventListener('click', ()=>{
    currentChosung += c;
    renderPetList();
    renderChosungTokens();
    Array.from(chosungBar.children).forEach(el=>el.classList.remove('on'));
    chip.classList.add('on');
  });
  chosungBar.appendChild(chip);
});
petSearch.addEventListener('input', renderPetList);

/* ========= 목록 ========= */
function renderPetList(){
  const kw = (petSearch.value||"").trim();
  const names = ALL_NAMES;
  const list = names.filter(n=>{
    const a = kw? n.includes(kw): true;
    const b = currentChosung? getChosung(n).startsWith(currentChosung): true;
    return a && b;
  });

  petList.innerHTML="";
  if(list.length===0){
    const d=document.createElement('div'); d.className='item'; d.textContent='결과 없음';
    petList.appendChild(d); return;
  }

  list.forEach(n=>{
    const div=document.createElement('div'); div.className='item';
    const left=document.createElement('div'); left.textContent = n;
    div.appendChild(left);
    div.addEventListener('click', ()=>{
      if(selectedItemEl) selectedItemEl.classList.remove('selected');
      div.classList.add('selected');
      selectedItemEl = div;
      selectPetName(n);
    });
    if (n === selectedName) { div.classList.add('selected'); selectedItemEl = div; }
    petList.appendChild(div);
  });
  renderChosungTokens();
}

/* ========= 펫 선택 ========= */
function selectPetName(n){
  selectedName=n;
  selectedRow=GLOBAL_TABLE[n]||null;

  if(selectedRow?.s0){
    s0hp.value=selectedRow.s0.hp.toFixed(2); s0atk.value=selectedRow.s0.atk.toFixed(2);
    s0def.value=selectedRow.s0.def.toFixed(2); s0agi.value=selectedRow.s0.agi.toFixed(2);
  }else{ s0hp.value=s0atk.value=s0def.value=s0agi.value=""; }

  if(selectedRow?.sg){
    sghp.value=selectedRow.sg.hp.toFixed(2); sgatk.value=selectedRow.sg.atk.toFixed(2);
    sgdef.value=selectedRow.sg.def.toFixed(2); sgagi.value=selectedRow.sg.agi.toFixed(2);
  }else{ sghp.value=sgatk.value=sgdef.value=sgagi.value=""; }

  if(selectedRow?.s0){
    obshp.value = Math.floor(selectedRow.s0.hp)||"";
    obsatk.value= Math.floor(selectedRow.s0.atk)||"";
    obsdef.value= Math.floor(selectedRow.s0.def)||"";
    obsagi.value= Math.floor(selectedRow.s0.agi)||"";
  }else{
    obshp.value=obsatk.value=obsdef.value=obsagi.value="";
  }
  showKpis(null);
}

/* ========= KPI 렌더 ========= */
function showKpis(res){
  if(!res){
    kpiSuccess.textContent = "—%"; kpiAppear .textContent = "—%"; kpiTries.textContent = "—";
    ringSuccess.style.setProperty("--p","0deg"); ringAppear .style.setProperty("--p","0deg");
    totMatches.textContent = "—"; rank8Matches.textContent = "—";
    distBox.innerHTML = "";
    return;
  }
  const matches = res.matches|0;
  const rank8   = res.rank8|0;
  const appear = matches/TOTAL*100;
  const successPct = matches? (rank8/matches*100): 0;
  const tries = successPct>0? (100/successPct) : Infinity;

  kpiSuccess.textContent = fmtPct(successPct);
  kpiAppear .textContent = fmtPct(appear);
  kpiTries  .textContent = (isFinite(tries) ? tries.toFixed(2) : "—");

  ringSuccess.style.setProperty("--p", (360 * successPct / 100) + "deg");
  ringAppear .style.setProperty("--p", (360 * appear / 100) + "deg");

  totMatches.textContent = matches.toLocaleString();
  rank8Matches.textContent = rank8.toLocaleString();

  const entries = Object.entries(res.dist).map(([r,c]) => ({r:parseInt(r,10), c})).sort((a,b) => b.r - a.r || b.c - a.c);
  let html = `<table class="table"><thead><tr><th>등급(베이스합)</th><th>건수</th><th>비율</th></tr></thead><tbody>`;
  const total = matches || 1;
  entries.forEach(e=>{
    const pct = (e.c/total*100).toFixed(2);
    const cls = (e.r===8 ? "ok" : (e.r>=5 ? "warn" : ""));
    html += `<tr><td class="${cls}">${e.r}</td><td>${e.c.toLocaleString()}</td><td>${pct}%</td></tr>`;
  });
  html += `</tbody></table>`;
  distBox.innerHTML = html;
}

/* ========= 관측치 편의 ========= */
function enableWheelStep(el){
  el.addEventListener('wheel',(e)=>{
    if(document.activeElement!==el) return;
    e.preventDefault();
    const delta = e.deltaY<0? 1 : -1;
    const curr = parseInt(el.value||"0",10);
    el.value = String(curr + delta);
  }, {passive:false});
}
[obsatk,obshp,obsdef,obsagi].forEach(enableWheelStep);
document.addEventListener('click', (e)=>{
  const btn = e.target.closest('[data-delta][data-target]'); if(!btn) return;
  const id = btn.getAttribute('data-target'); const delta = parseInt(btn.getAttribute('data-delta'),10);
  const input=document.getElementById(id); if(!input) return;
  const curr=parseInt(input.value||"0",10); input.value=String(curr+delta);
});

/* ========= 엔진(합산 후 floor) - 꼬비아빠 로직 ========= */
function enumerate_kkoby(pku, obs){
  const k = new Decimal(pku.k);
  const fac = k.dividedBy(100);
  const u = pku.u;

  let matches = 0, rank8 = 0;
  const dist = {};

  const baseCnt = 5;
  const baseInit = -2;

  for(let hr=baseInit; hr<baseInit+baseCnt; hr++){
    for(let ar=baseInit; ar<baseInit+baseCnt; ar++){
      for(let dr=baseInit; dr<baseInit+baseCnt; dr++){
        for(let gr=baseInit; gr<baseInit+baseCnt; gr++){
          for(let hb=0; hb<=10; hb++){
            for(let ab=0; ab<=10; ab++){
              for(let db=0; db<=10; db++){
                const gb = 10 - hb - ab - db;
                if(gb < 0 || gb > 10) continue;

                const baseH = new Decimal(u.hp + hr + hb);
                const baseA = new Decimal(u.atk + ar + ab);
                const baseD = new Decimal(u.def + dr + db);
                const baseG = new Decimal(u.agi + gr + gb);

                const iH = baseH.times(fac);
                const iA = baseA.times(fac);
                const iD = baseD.times(fac);
                const iG = baseG.times(fac);
                
                // 꼬비아빠 계산기 로직: 각 스탯 계산 시 preciseRound(Math.round(num * 1e12) / 1e12) 적용
                const preciseRound = (num) => new Decimal(num.toPrecision(15)).toDP(12);

                const r_hp = preciseRound(iH);
                const r_atk = preciseRound(iA);
                const r_def = preciseRound(iD);
                const r_agi = preciseRound(iG);

                const calcHp  = preciseRound(r_hp.times(4).plus(r_atk).plus(r_def).plus(r_agi)).floor().toNumber();
                const calcAtk = preciseRound(r_hp.times(0.1).plus(r_atk).plus(r_def.times(0.1)).plus(r_agi.times(0.05))).floor().toNumber();
                const calcDef = preciseRound(r_hp.times(0.1).plus(r_atk.times(0.1)).plus(r_def).plus(r_agi.times(0.05))).floor().toNumber();
                const calcAgi = preciseRound(r_agi).floor().toNumber();

                if(calcHp===obs[0] && calcAtk===obs[1] && calcDef===obs[2] && calcAgi===obs[3]){
                  matches++;
                  const r = hr + ar + dr + gr;
                  dist[r] = (dist[r]||0) + 1;
                  if(r === 8) rank8++;
                }
              }
            }
          }
        }
      }
    }
  }
  return {matches, rank8, dist};
}

/* ========= 계산 ========= */
btnCalc.addEventListener('click', ()=>{
  if(!selectedName){ alert("펫을 먼저 선택하세요."); return; }
  const obs=[obshp,obsatk,obsdef,obsagi].map(e=>parseInt(e.value,10));
  if(obs.some(v=>!Number.isFinite(v))){ alert("관측 표기치(정수)를 모두 입력하세요."); return; }

  const row=GLOBAL_TABLE[selectedName]||{};
  if(!row?.k || !row?.u){ alert("이 펫은 데이터(k/u)가 등록되어 있지 않습니다."); return; }
  
  // 꼬비아빠 계산 엔진 사용
  const res = enumerate_kkoby({k: row.k, u: row.u}, obs);
  showKpis(res);
});

btnReset.addEventListener('click', ()=>{
  selectedName=null; selectedRow=null;
  petSearch.value=""; currentChosung="";
  Array.from(chosungBar.children).forEach(el=>el.classList.remove('on'));
  petList.querySelectorAll('.item.selected').forEach(el=>el.classList.remove('selected'));
  selectedItemEl = null;
  renderPetList();
  [s0hp,s0atk,s0def,s0agi,sghp,sgatk,sgdef,sgagi,obshp,obsatk,obsdef,obsagi].forEach(i=>i.value="");
  showKpis(null);
});
btnClear.addEventListener('click', ()=>{
  petSearch.value=""; currentChosung="";
  Array.from(chosungBar.children).forEach(el=>el.classList.remove('on'));
  petList.querySelectorAll('.item.selected').forEach(el=>el.classList.remove('selected'));
  selectedItemEl = null;
  renderPetList();
});

/* ========= 테마 토글 ========= */
const themeToggleBtn = document.getElementById('theme-toggle');
themeToggleBtn.addEventListener('click', () => {
    document.body.classList.toggle('light');
    if (document.body.classList.contains('light')) {
        themeToggleBtn.textContent = '다크 모드';
    } else {
        themeToggleBtn.textContent = '라이트 모드';
    }
});

/* ========= 부팅 ========= */
(function init(){
  buildPetTable();
  renderPetList();
})();
</script>
</body>
</html>
